 --- BIN FILE READ: seq_QFS_maps
  11181 INCLUDE 'seq_QFS_maps';
  11182   PROCEDURE PICK INDEX MAPARR SPNRARR;
  11183     VARIABLE I 1;
  11184     VARIABLE J 1;
  11185     LOOP I 1 TWOND;
  11186       MSC(I) := MAPARR(I, INDEX);
  11187       ENDLOOP;
  11188     LOOP I 1 3;
  11189       LOOP J 1 3;
  11190         SSCR(I,J) := SPNRARR(I,J,INDEX) + 0*DD(1);
  11191         ENDLOOP;
  11192       ENDLOOP;
  11193     ENDPROCEDURE;
  11194   PROCEDURE MAKEMAP FROM TO START MAPARR SPNRARR;
  11195     VARIABLE J 1;
  11196     WRITE 6 '* '&ST(START);
  11197     LMAPS START MAPARR SPNRARR; %LMAPS:10125
  11198     LOOP J (START+1) TO;
  11199       WRITE 6 '**       '&ST(J);
  11200       PICK J MAPARR SPNRARR; %PICK:11182
  11201       LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  11202       UPDATE 1 1; %UPDATE: 1261
  11203       ENDLOOP;
  11204     LOOP J FROM (START-1);
  11205       WRITE 6 '**       '&ST(J);
  11206       PICK J MAPARR SPNRARR; %PICK:11182
  11207       LOCSET 0 0 0 0 0 0; %LOCSET: 1114
  11208       UPDATE 1 1; %UPDATE: 1261
  11209       ENDLOOP;
  11210     ENDPROCEDURE;
  11211   PROCEDURE GETTWISS0 COORD AL0 BET0 GAM0 MAPARR SPNRARR;
  11212     VARIABLE NUM1 1;
  11213     VARIABLE NUM2 1;
  11214     VARIABLE OBJ 1;
  11215     IF COORD='X';
  11216       NUM1:=1;
  11217       NUM2:=2;
  11218       AL0:=0;
  11219       BET0:=20.0;
  11220       GAM0:=1.0/BET0;
  11221       ELSEIF COORD='Y';
  11222       NUM1:=3;
  11223       NUM2:=4;
  11224       AL0:=0;
  11225       BET0:=3;
  11226       GAM0:=1.0/BET0;
  11227       ELSEIF LO(1);
  11228       WRITE 6 'UNKNOWN COORDINATE';
  11229       ENDIF;
  11230     FIT AL0 BET0 GAM0;
  11231       OBJ:= SQR(SQR(ME(NUM1,NUM1))*BET0-2*ME(NUM1,NUM1)*ME(NUM1,NUM2)*
                  AL0+SQR(ME(NUM1,NUM2))*GAM0-BET0); %ME:  516 %ME:  516 %ME: 
                   516 %ME:  516
  11232       OBJ:=OBJ+ SQR(-ME(NUM1,NUM1)*ME(NUM2,NUM1)*BET0+( ME(NUM1,NUM1)*
                  ME(NUM2,NUM2)+ME(NUM1,NUM2)*ME(NUM2,NUM1) )*AL0-ME(NUM1,NUM2
                  )*ME(NUM2,NUM2)*GAM0-AL0); %ME:  516 %ME:  516 %ME:  516 %ME
                  :  516 %ME:  516 %ME:  516 %ME:  516 %ME:  516
  11233       OBJ:=OBJ+ SQR((ME(NUM2,NUM1)^2)*BET0-2*ME(NUM2,NUM1)*ME(NUM2,NUM
                  2)*AL0+(ME(NUM2,NUM2)^2)*GAM0-(1+AL0^2)/BET0)  ; %ME:  516 %
                  ME:  516 %ME:  516 %ME:  516
  11234       ENDFIT 1E-20 5000 1 OBJ;
  11235     ENDPROCEDURE;
  11236   PROCEDURE BETS TAG COORD NUM_ELE AL0 BET0 GAM0 BETS MAPARR SPNRARR;
  11237     VARIABLE J 1;
  11238     VARIABLE NUM1 1;
  11239     VARIABLE NUM2 1;
  11240     IF COORD='X';
  11241       NUM1:=1;
  11242       NUM2:=2;
  11243       ELSEIF COORD='Y';
  11244       NUM1:=3;
  11245       NUM2:=4;
  11246       ELSEIF LO(1);
  11247       WRITE 6 'UNKNOWN COORDINATE';
  11248       ENDIF;
  11249     UM; %UM: 1488
  11250     BETS(1):=BET0;
  11251     OPENF 800 TAG 'REPLACE';
  11252     WRITE 800 ST(BETS(1))&'     '&ST(0);
  11253     LOOP J 1 NUM_ELE;
  11254       MAKEMAP 1 J 1 MAPARR SPNRARR; %MAKEMAP:11194
  11255       BETS(J+1):=(ME(NUM1,NUM1)^2)*BET0-2*ME(NUM1,NUM1)*ME(NUM1,NUM2)*
                  AL0+(ME(NUM1,NUM2)^2)*GAM0; %ME:  516 %ME:  516 %ME:  516 %M
                  E:  516
  11256       WRITE 800 ST(BETS(J+1))&'     '&ST(J);
  11257       UM; %UM: 1488
  11258       ENDLOOP;
  11259     CLOSEF 800;
  11260     ENDPROCEDURE;
  11261   PROCEDURE GETDISP0 COORD D0 DPR0 MAPARR SPNRARR;
  11262     VARIABLE NUM1 1;
  11263     VARIABLE NUM2 1;
  11264     VARIABLE OBJ 1;
  11265     IF COORD='X';
  11266       NUM1:=1;
  11267       NUM2:=2;
  11268       D0:=0;
  11269       DPR0:=0;
  11270       ELSEIF COORD='Y';
  11271       NUM1:=3;
  11272       NUM2:=4;
  11273       D0:=0;
  11274       DPR0:=0;
  11275       ELSEIF LO(1);
  11276       WRITE 6 'UNKNOWN COORDINATE';
  11277       ENDIF;
  11278     FIT D0 DPR0;
  11279       OBJ:= SQR(  ME(NUM1,NUM1)*D0+ME(NUM1,NUM2)*DPR0+ME(NUM1,6)*(1+1/
                  (CONS(ETA)+1))-D0  ); %ME:  516 %ME:  516 %ME:  516
  11280       OBJ:=OBJ+ SQR(  ME(NUM2,NUM1)*D0+ME(NUM2,NUM2)*DPR0+ME(NUM2,6)*(
                  1+1/(CONS(ETA)+1))-DPR0  )  ; %ME:  516 %ME:  516 %ME:  516
  11281       ENDFIT 1E-20 5000 1 OBJ;
  11282     WRITE 6 'DISP'&COORD&'0' 'DISP_PRIME'&COORD&'0';
  11283     WRITE 6 D0 DPR0;
  11284     ENDPROCEDURE;
  11285   PROCEDURE DISPS TAG COORD NUM_ELE D0 DPR0 DS MAPARR SPNRARR;
  11286     VARIABLE J 1;
  11287     VARIABLE NUM1 1;
  11288     VARIABLE NUM2 1;
  11289     IF COORD='X';
  11290       NUM1:=1;
  11291       NUM2:=2;
  11292       ELSEIF COORD='Y';
  11293       NUM1:=3;
  11294       NUM2:=4;
  11295       ELSEIF LO(1);
  11296       WRITE 6 'UNKNOWN COORDINATE';
  11297       ENDIF;
  11298     UM; %UM: 1488
  11299     DS(1):=D0;
  11300     OPENF 800 TAG 'REPLACE';
  11301     WRITE 800 ST(DS(1))&'     '&ST(0);
  11302     LOOP J 1 NUM_ELE;
  11303       MAKEMAP 1 J 1 MAPARR SPNRARR; %MAKEMAP:11194
  11304       DS(J+1):=ME(NUM1,NUM1)*D0+ME(NUM1,NUM2)*DPR0+ ME(NUM1,6)*(1+1/(C
                  ONS(ETA)+1)); %ME:  516 %ME:  516 %ME:  516
  11305       WRITE 800 ST(DS(J+1))&'     '&ST(J);
  11306       UM; %UM: 1488
  11307       ENDLOOP;
  11308     CLOSEF 800;
  11309     ENDPROCEDURE;
  11310   PROCEDURE MAIN;
  11311     VARIABLE GAMMA 1;
  11312     VARIABLE SGX1 1;
  11313     VARIABLE SGX2 1;
  11314     VARIABLE SGY1 1;
  11315     VARIABLE SGY2 1;
  11316     VARIABLE EB1 1;
  11317     VARIABLE ALPHAX0 1;
  11318     VARIABLE BETAX0 1;
  11319     VARIABLE GAMMAX0 1;
  11320     VARIABLE BETAXS 1 313;
  11321     VARIABLE ALPHAY0 1;
  11322     VARIABLE BETAY0 1;
  11323     VARIABLE GAMMAY0 1;
  11324     VARIABLE BETAYS 1 313;
  11325     VARIABLE DISPX0 1;
  11326     VARIABLE DISPXPR0 1;
  11327     VARIABLE DISPXS 1 313;
  11328     VARIABLE DISPY0 1;
  11329     VARIABLE DISPYPR0 1;
  11330     VARIABLE DISPYS 1 313;
  11331     VARIABLE MAPARR1 1000 6 313;
  11332     VARIABLE SPNRARR1 1000 3 3 313;
  11333     VARIABLE NUM_ELE 1;
  11334     VARIABLE TILT 48;
  11335     GAMMA := 1.143914;
  11336     NUM_ELE := 162;
  11337     OV 3 3 0; %OV:  969
  11338     SET_FOR_DEUTERONS GAMMA; %SET_FOR_DEUTERONS:10611
  11339     EB1 := 119.9893250407470;
  11340     SGX1 :=  0.0;
  11341     SGY1  := 0.0;
  11342     SGX2 :=  0.0;
  11343     SGY2  := 0.0;
  11344     BETAX0 :=2.79613;
  11345     BETAY0 :=15.2847 ;
  11346     ALPHAX0:=0.0;
  11347     ALPHAY0:=0.0;
  11348     GAMMAX0:=(1+SQR(ALPHAX0))/BETAX0;
  11349     GAMMAY0:=(1+SQR(ALPHAY0))/BETAY0;
  11350     DISPX0  :=-0.0229749;
  11351     DISPXPR0:=0.0;
  11352     DISPY0  :=0.0;
  11353     DISPYPR0:=0.0;
  11354     LATTICE SGX1 SGY1 SGX2 SGY1 EB1 0 MAPARR1 SPNRARR1; %LATTICE:10648

  11355     PM 6; %PM: 1574
  11356     WRITE 6 '++++++++++ Magnetic Rigidity';
  11357     WRITE 6 CONS(CHIM);
  11358     WRITE 6 ME(3,6); %ME:  516
  11359     BETS 'BETAX' 'X' NUM_ELE ALPHAX0 BETAX0 GAMMAX0 BETAXS MAPARR1 SPN
                  RARR1; %BETS:11236
  11360     BETS 'BETAY' 'Y' NUM_ELE ALPHAY0 BETAY0 GAMMAY0 BETAYS MAPARR1 SPN
                  RARR1; %BETS:11236
  11361     DISPS 'DISPX' 'X' NUM_ELE DISPX0 DISPXPR0 DISPXS MAPARR1 SPNRARR1;
                   %DISPS:11285
  11362     ENDPROCEDURE;
  11363   PROCEDURE RUN;
  11364     MAIN; %MAIN:11310
  11365     ENDPROCEDURE;
  11366   RUN; %RUN:11363
